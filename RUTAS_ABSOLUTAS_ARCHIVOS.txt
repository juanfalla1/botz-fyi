================================================================================
RUTAS ABSOLUTAS: TODOS LOS ARCHIVOS INVESTIGADOS
================================================================================

PROBLEMA 1: GOOGLE OAUTH
================================================================================

üìÑ AUTENTICACI√ìN OAUTH - Supabase Client
   C:\Users\USUARIO\botz-fyi\supabaseClient.ts
   L√≠neas: 1-21
   Estado: ‚úÖ Configurado correctamente

üìÑ AUTENTICACI√ìN MODAL - AuthModal Component
   C:\Users\USUARIO\botz-fyi\app\start\components\AuthModal.tsx
   L√≠neas: 33-49 (funci√≥n handleGoogle)
   Estado: ‚úÖ C√≥digo correcto
   Dependencia: Requiere Google OAuth en Supabase Dashboard

üìÑ P√ÅGINA DE PRECIOS - Google Login
   C:\Users\USUARIO\botz-fyi\app\pricing\page.tsx
   L√≠neas: 330-342 (funci√≥n handleGoogleLogin)
   Estado: ‚úÖ C√≥digo correcto
   Dependencia: Requiere Google OAuth en Supabase Dashboard

üìÑ VARIABLES DE ENTORNO
   C:\Users\USUARIO\botz-fyi\.env.local
   L√≠neas: 1-2, 15-17
   Contenido:
     - NEXT_PUBLIC_SUPABASE_URL
     - NEXT_PUBLIC_SUPABASE_ANON_KEY
     - GOOGLE_CLIENT_ID
     - GOOGLE_CLIENT_SECRET
   Estado: ‚úÖ Presente

‚ö†Ô∏è  CONFIGURACI√ìN EXTERNA (No en archivos):
   - Supabase Dashboard: https://app.supabase.com/project/chyzxaspglbwnenagtjv
     - Authentication > Providers > Google
     - Status: ‚ùå DEBE ESTAR HABILITADO CON CREDENCIALES


PROBLEMA 2: FLUJO DEMO/TRIAL
================================================================================

‚ùå ARCHIVO CR√çTICO - ACEPTACI√ìN DE INVITACI√ìN
   C:\Users\USUARIO\botz-fyi\app\accept-invite\[inviteId]\page.tsx
   L√≠neas: 114-172 (funci√≥n handleSetupPassword)
   Problema: No crea tenant_id, team_member, ni subscription
   Acci√≥n Requerida: MODIFICAR C√ìDIGO
   C√≥digo a agregar: Ver COMPARACION_FLUJOS_AUTH.txt

‚úÖ ARCHIVO SECUNDARIO - VALIDACI√ìN DE INVITACI√ìN
   C:\Users\USUARIO\botz-fyi\app\api\platform\admin-invites\validate\route.ts
   L√≠neas: 9-59
   Estado: Correcto, solo valida

‚ùå ARCHIVO CR√çTICO - CARGA DE FEATURES
   C:\Users\USUARIO\botz-fyi\app\start\MainLayout.tsx
   L√≠neas: 68-78 (PLAN_FEATURES)
   L√≠neas: 322-343 (applySubscription)
   L√≠neas: 396-531 (fetchUserSubscription)
   L√≠neas: 540-637 (detectUserRole)
   Problema: Depende de que usuario tenga tenant_id y subscription
   Dependencia: Fix del archivo anterior

‚ùå ARCHIVO CR√çTICO - API GUARDS
   C:\Users\USUARIO\botz-fyi\app\api\_utils\guards.ts
   L√≠neas: 58-91 (funci√≥n assertTenantAccess)
   Problema: Bloquea sin tenantId para platform_admins
   Dependencia: Fix del archivo anterior

‚úÖ ARCHIVO SECUNDARIO - CHECKOUT STRIPE
   C:\Users\USUARIO\botz-fyi\app\api\stripe\create-checkout-session\route.ts
   L√≠neas: 59-124
   Estado: Correcto, requiere tenantId


PROBLEMA 3: EMAIL info@botz.fyi FUNCIONA
================================================================================

‚úÖ NO HAY PROBLEMA - ESTE ES EL FLUJO CORRECTO
   
   El flujo normal funciona porque:
   - Usuario tiene entrada en team_members con tenant_id
   - Usuario tiene entrada en subscriptions
   - MainLayout puede detectar ambos valores
   - API Guards validan correctamente
   
   Archivos:
   - C:\Users\USUARIO\botz-fyi\app\start\MainLayout.tsx (l√≠neas 540-637)
   - C:\Users\USUARIO\botz-fyi\app\api\_utils\guards.ts (l√≠neas 41-56)


ARCHIVOS COMPLEMENTARIOS
================================================================================

üìÑ OTP REQUEST (Email/Auth alternativo)
   C:\Users\USUARIO\botz-fyi\app\api\auth\request-otp\route.ts
   Estado: ‚úÖ Funciona, no es problema
   Funci√≥n: Verificaci√≥n 2FA v√≠a OTP

üìÑ OTP VERIFY
   C:\Users\USUARIO\botz-fyi\app\api\auth\verify-otp\route.ts
   Estado: ‚úÖ Funciona, no es problema
   Funci√≥n: Validar c√≥digos OTP

üìÑ LOGIN PAGE (Deprecated)
   C:\Users\USUARIO\botz-fyi\app\login\page.tsx
   Estado: ‚úÖ Redirige a /start
   Nota: P√°gina deprecated, mantiene compatibilidad

üìÑ PAGE PRINCIPAL
   C:\Users\USUARIO\botz-fyi\app\start\page.tsx
   L√≠neas: 108+
   Estado: ‚úÖ Usa MainLayout
   Funci√≥n: Punto de entrada a la app


GOOGLE INTEGRATIONS (No son de autenticaci√≥n)
================================================================================

üìÑ GOOGLE OAUTH INIT
   C:\Users\USUARIO\botz-fyi\app\api\integrations\google\init\route.ts
   L√≠neas: 8-68
   Funci√≥n: Iniciar OAuth para conexi√≥n de Gmail (no auth)
   Estado: ‚úÖ Correcto

üìÑ GOOGLE OAUTH CALLBACK
   C:\Users\USUARIO\botz-fyi\app\api\integrations\google\callback\route.ts
   L√≠neas: 31-195
   Funci√≥n: Recibir callback de Google para Gmail (no auth)
   Estado: ‚úÖ Correcto

üìÑ GOOGLE SYNC GMAIL
   C:\Users\USUARIO\botz-fyi\app\api\integrations\google\sync-gmail\route.ts
   Funci√≥n: Sincronizar emails desde Gmail
   Estado: ‚úÖ Correcto

üìÑ GOOGLE SEND GMAIL
   C:\Users\USUARIO\botz-fyi\app\api\integrations\google\send-gmail\route.ts
   Funci√≥n: Enviar emails desde Gmail
   Estado: ‚úÖ Correcto


TABLAS DE BASE DE DATOS AFECTADAS
================================================================================

üìä TABLA: auth.users (Supabase)
   - user_id (auth_user_id)
   - email
   - user_metadata (contiene tenant_id para OAuth)
   - app_metadata (provider: 'google', etc)

üìä TABLA: public.tenants
   - id (UUID)
   - name
   - owner_id
   Nota: Para demo users, DEBE CREARSE ENTRADA

üìä TABLA: public.team_members
   - id
   - auth_user_id
   - email
   - tenant_id ‚Üê CR√çTICO
   - rol
   - activo
   - permissions
   Nota: Para demo users, DEBE CREARSE ENTRADA

üìä TABLA: public.subscriptions
   - id
   - tenant_id ‚Üê CR√çTICO para b√∫squeda
   - user_id
   - plan
   - status
   - trial_start
   - trial_end
   Nota: Para demo users, DEBE CREARSE ENTRADA

üìä TABLA: public.platform_admins
   - auth_user_id
   Nota: Demo users S√ç se agregan aqu√≠ (correcto)

üìä TABLA: public.admin_invites
   - id
   - email
   - role
   - access_level
   - status
   - expires_at
   Nota: Existe y funciona correctamente


VARIABLES DE ENTORNO CONFIGURADAS
================================================================================

‚úÖ SUPABASE (en .env.local l√≠nea 1-5):
   NEXT_PUBLIC_SUPABASE_URL=https://chyzxaspglbwnenagtjv.supabase.co
   NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   SUPABASE_URL=https://chyzxaspglbwnenagtjv.supabase.co
   SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

‚úÖ GOOGLE (en .env.local l√≠nea 15-17):
   GOOGLE_CLIENT_ID=417058045568-hheokiaia74qgr7lvfcgugpbenq8kq3t.apps.googleusercontent.com
   GOOGLE_CLIENT_SECRET=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
   GOOGLE_REDIRECT_URI=http://localhost:3000/api/integrations/google/callback

‚úÖ STRIPE (en .env.local l√≠nea 7-13):
   STRIPE_SECRET_KEY=sk_test_51SvQ7X2a7HFRxbhSJzmb16laRY0UgrBbK8XIcuvUULAABofVbkCxyG7s22aKBdHLcFCNP8uNdVhl9gGVbxvEO5Ze007i8zkJre
   STRIPE_WEBHOOK_SECRET=whsec_UAri2lFygPmAHy78HEvKq9W0mb9TyTfO
   STRIPE_PRICE_BASIC_MONTHLY=price_1SvQCC2a7HFRxbhS1TZEjL2C
   STRIPE_PRICE_BASIC_YEARLY=price_1Sxs472a7HFRxbhSKFqJhrzP
   STRIPE_PRICE_GROWTH_MONTHLY=price_1SvQDT2a7HFRxbhSfmd1ZCgN
   STRIPE_PRICE_GROWTH_YEARLY=price_1SznZM2a7HFRxbhScUKTYzYP

‚úÖ EMAIL (en .env.local l√≠nea 25-30):
   ZOHO_HOST=smtp.zohocloud.ca
   ZOHO_PORT=465
   ZOHO_USER=info@botz.fyi
   ZOHO_APP_PASSWORD=NB1QGuGssK6E
   MAIL_TO=info@botz.fyi
   MAIL_FROM=info@botz.fyi

‚ùå FALTA EN SUPABASE DASHBOARD (No en archivos):
   - Google OAuth Provider habilitado
   - Credenciales de Google agregadas


DOCUMENTOS GENERADOS EN ESTA INVESTIGACI√ìN
================================================================================

üìÑ RESUMEN_INVESTIGACION_FINAL.md
   C:\Users\USUARIO\botz-fyi\RESUMEN_INVESTIGACION_FINAL.md
   - Overview ejecutivo
   - Problemas identificados
   - Soluciones r√°pidas
   - Checklist

üìÑ INVESTIGACION_PROBLEMAS_AUTENTICACION.md
   C:\Users\USUARIO\botz-fyi\INVESTIGACION_PROBLEMAS_AUTENTICACION.md
   - An√°lisis t√©cnico detallado
   - C√≥digo l√≠nea por l√≠nea
   - Explicaci√≥n de cada problema
   - Debugging steps

üìÑ ARCHIVOS_CRITICOS_ENCONTRADOS.txt
   C:\Users\USUARIO\botz-fyi\ARCHIVOS_CRITICOS_ENCONTRADOS.txt
   - Mapeo de archivos por probl
